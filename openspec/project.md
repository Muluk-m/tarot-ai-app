# Project Context

## Purpose
**Tarot AI** is a cross-platform mobile application (iOS/Android) that provides AI-powered tarot card readings. Users can draw single cards or three-card spreads (past/present/future) and receive mystical interpretations generated by AI.

## Tech Stack
- **Frontend**: React Native 0.81.5 with React 19
- **Framework**: Expo SDK 54 + Expo Router (file-based routing)
- **Language**: TypeScript
- **Styling**: NativeWind (Tailwind CSS for React Native)
- **State Management**: Zustand
- **AI Integration**: Dify API for tarot interpretations
- **Package Manager**: pnpm
- **Animations**: React Native Reanimated

## Project Conventions

### Code Style
- **Formatting**: Use `pnpm format` (configured formatter)
- **Linting**: Use `pnpm lint` before commits
- **TypeScript**: Strict mode enabled
- **Import Aliases**: Uses `tsconfigPaths` experiment
- **No Emojis**: Avoid emojis in code unless explicitly requested
- **Comments**: Minimal - only add where logic isn't self-evident

### Architecture Patterns
- **File-based Routing**: Expo Router in `app/` directory
  - Grouped routes use `(groupName)/` pattern
  - `_layout.tsx` for nested layouts
- **State Management**: Three Zustand stores
  - `userStore` - User profile, daily limits, preferences
  - `cardStore` - Tarot deck operations, shuffling, drawing
  - `readingStore` - Current reading, history, AI results
- **Styling**: NativeWind className utilities
  - Dark mystic theme (purple/gold accents)
  - Custom color palette in `tailwind.config.js`
- **API Services**: Centralized in `src/services/`
  - 30-second timeout for API calls
  - axios for HTTP requests
- **Persistence**: AsyncStorage for user data and reading history

### Testing Strategy
- Tests for existing behavior only
- No test files created yet (future requirement)
- Manual testing via Expo Go app on devices

### Git Workflow
- **Main Branch**: `main` (default for PRs)
- **Package Manager**: pnpm (no npm/yarn)
- **Commits**: Descriptive messages, no hooks configured yet
- **No Force Push**: Never force push to main/master

## Domain Context

### Tarot Card System
- **78 Cards Total**: 22 Major Arcana + 56 Minor Arcana
- **Minor Arcana Suits**: Wands, Cups, Swords, Pentacles
- **Card Properties**: id, name, arcana, keywords, meanings, symbolism
- **Spread Types**:
  - `single` - One card draw
  - `three` - Past/Present/Future spread

### Reading Mechanics
- **Daily Limits**: 3 readings/day for free users (resets at midnight)
- **Shuffling**: Fisher-Yates algorithm for randomness
- **History**: Persistent storage with favorites capability
- **AI Interpretation**: Generated via Dify API based on drawn cards

### User Experience
- Dark mode only (`userInterfaceStyle: "dark"`)
- Mystical aesthetic with gold (#D4AF37) and purple (#8B5CF6) accents
- Typography: Cinzel (headings), Inter (body text)

## Important Constraints

### Feature Restrictions
- **No Sharing**: Social sharing explicitly disabled per user request
- **No Premium**: Premium features planned but not yet implemented
- **No Notifications**: Future feature, currently disabled

### Technical Constraints
- Must work on both iOS and Android
- Requires network connection for AI interpretations
- 30-second API timeout limit
- AsyncStorage limitations for data persistence

### Bundle Identifiers
- iOS: `com.qlj.tarotai`
- Android: `com.qlj.tarotai`

## External Dependencies

### Dify AI API
- **Purpose**: Generate tarot card interpretations
- **Configuration**: Environment variables required
  - `EXPO_PUBLIC_DIFY_API_URL`
  - `EXPO_PUBLIC_DIFY_API_KEY`
- **Timeout**: 30 seconds
- **Service Location**: `src/services/` (to be implemented)

### React Native Async Storage
- **Purpose**: Persist user data and reading history
- **Usage**: User settings, daily reading counts, reading history records

### Expo Services
- Development: Expo Go app for testing
- Build: EAS Build for production (future)
- Updates: OTA updates capability (future)
